<div class="modal-header">
  <h5 class="modal-title">Complete Your Purchase</h5>
  <button type="button" class="btn-close" (click)="activeModal.dismiss()" aria-label="Close"></button>
</div>

<div class="modal-body">
  <div class="property-summary mb-4 p-3 border rounded">
    <h4>{{ property.title }}</h4>
    <p class="text-muted">{{ property.location }}</p>
    <div class="d-flex justify-content-between align-items-center">
      <span class="fw-bold">Price:</span>
      <span class="text-primary fw-bold">{{ formatPrice(property.price) }}</span>
      @if(finalPrice>0)
      {
        <span class="fw-bold">Price After Discount:</span>
      <span class="text-primary fw-bold">{{ formatPrice(finalPrice) }}</span>
      }
    </div>
  </div>
        <!-- <label for="Discountcode">Discount Code (optional)</label>
      <div class="discount-container">
        <input type="text" class="discount-code" name="DiscountCode" (change)="checkDiscountCode()">
      </div> -->
      <label for="Discountcode">Discount Code (optional)</label>
<div class="discount-container">
  <input
    type="text"
    class="discount-code form-control"
    [(ngModel)]="discountCode"
    name="discountCode"
    (input)="checkDiscountCode(discountCode)"
    [disabled]="discountValid === true"
  />
  

  <div *ngIf="discountValid === true" class="text-success mt-1">
     Code is valid and Discount Percentage: {{discountDetails?.discountPercentage}}
  </div>
  <div *ngIf="discountValid === false" class="text-danger mt-1">
     Invalid discount code
  </div>
</div>

      
  <br>
  <div class="mb-4">
    <h6 class="mb-3">Payment Method</h6>
    <div class="form-check mb-2">
      <input class="form-check-input" type="radio" name="paymentMethod" 
             id="bankTransfer" value="bank_transfer" [(ngModel)]="paymentMethod" checked>
      <label class="form-check-label" for="bankTransfer">
        Bank Transfer
      </label>
    </div>
    <div class="form-check mb-2">
      <input class="form-check-input" type="radio" name="paymentMethod" 
             id="creditCard" value="credit_card" [(ngModel)]="paymentMethod">
      <label class="form-check-label" for="creditCard">
        Credit Card
      </label>
    </div>
    <div class="form-check">
      <input class="form-check-input" type="radio" name="paymentMethod" 
             id="upi" value="upi" [(ngModel)]="paymentMethod">
      <label class="form-check-label" for="upi">
        UPI Payment
      </label>
    </div>
  </div>

  <div class="mb-4">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" id="termsCheck" [(ngModel)]="agreedToTerms">
      <label class="form-check-label" for="termsCheck">
        I agree to the terms and conditions
      </label>
    </div>
  </div>
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-secondary" (click)="activeModal.dismiss()">Cancel</button>
  <button type="button" class="btn btn-primary" (click)="confirmPurchasev2()" [disabled]="isLoading">
    <span *ngIf="!isLoading">Confirm Purchase</span>
    <span *ngIf="isLoading">
      <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      Processing...
    </span>
  </button>
</div>